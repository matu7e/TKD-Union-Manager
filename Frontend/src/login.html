<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jwt-decode/3.1.2/jwt-decode.min.js"></script>
    <title>Unión Mediterránea - Taekwondo IFT</title>
    <link rel="shortcut icon" href="../assets/union.ico" type="image/x-icon">
    <link rel="stylesheet" href="../styles/login.css">
    <link rel="stylesheet" href="../styles/footer.css">
    <link rel="stylesheet" href="../styles/menu.css">
    
    
</head>
<style>
     /* Contenedor de alertas */
 .alert-container {
  position: fixed;
  bottom: 0;
  left: 0;
  display: flex;
  flex-direction: column;
  gap: 10px; /* Espacio entre las alertas */
  z-index: 1000; /* Para asegurarse de que esté encima de otros elementos */
  
}

/* Estilos para las alertas */
.alert {
  padding: 15px;
  width: 450px;
  border-right: 4px;
  color: #fff;
  box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.1);
}
.alert-aviso{
  background-color: #f36b2b;
  display: none;
  color: #000;
  
}
.alert-danger {
  background-color: #bd2d2a;
  display: none;
}

.alert-success {
  background-color: #2c9900;
  display: none;
}       
      
.disabled {
  opacity: 0.6;
}

</style>
<body>
    <header class="navbar">
        <div class="navbar-left">
            <a href="../Index.html">
                <img src="../assets/log4.png" alt="Logo" class="navbar-logo"> <!-- Reemplaza con la ruta de tu logo -->
                <h1 class="navbar-title">UNION MEDITERRANEA</h1>
            </a>
            
        </div>
        <nav class="navbar-menu" id="navbar-menu">
            <ul>
                <img src="../assets/log1.png" alt="Logo" class="navbar-logo-U"> <!-- Reemplaza con la ruta de tu logo -->
                <li><a href="../Index.html#Calendairo">Calendario</a></li>
                <li><a href="../Index.html#Sedes">Sedes</a></li>
                <li><a href="../Index.html#Autoridades">Autoridades</a></li>
                <li><a href="../Index.html#Galeria">Galeria</a></li>
                <li><a href="login.html" class="login-btn" id="showLoginFromMenu">Iniciar Sesión</a></li>
            </ul>
        </nav>
        <i class="fas fa-bars hamburger" id="hamburger"></i> <!-- Ícono de hamburguesa -->
    </header>
    <div class="alert-container">
        <div id="alert-aviso" class="alert alert-aviso">            
        </div>
        <div id="alert-success" class="alert alert-success">            
        </div>
        <div id="alert-error" class="alert alert-danger">
        </div>
    </div>
    
    <main  class="main-content">
        <div class="container">
            <h1>Unión Mediterránea</h1>
            <h2>Taekwondo IFT</h2>
            <div class="form-container" id="formContainer">
                
                <!-- Formulario de Login -->
                <form class="form login-form" id="loginForm" method="POST" action="">
                    <img src="../assets/log1.png" alt="Logo" class="logo">
                    <div class="form-group">
                        <label for="loginUsername">N° Documento:</label>
                        <input type="text" id="loginUsername" name="Número de Documento" placeholder="Número de Documento" required>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Contraseña:</label>
                        <input type="password" id="loginPassword" name="password" placeholder="Contraseña" required>
                    </div>
                    <button type="submit" class="btn-login">Ingresar</button>
                    <p class="switch-form">
                        ¿No tienes cuenta? <a href="#" id="showRegister">Registrarse</a>
                    </p>
                </form>

                <!-- Paso 1: Datos de Usuario -->
                <div class="form register-form" id="step1Form" style="display: none;">
                    <img src="../assets/log1.png" alt="Logo" class="logo">
                    <div class="form-group">
                        <label for="tipoDocumento">Tipo de Documento:</label>
                        <select id="tipoDocumento" required>
                            <option value="" disabled selected>Seleccionar tipo de documento</option>
                            <option value="DNI">DNI</option>
                            <option value="Pasaporte">Pasaporte</option>
                            <option value="CUIL">CUIL</option>
                            <option value="Cedula">Cédula de Identidad</option>
                        </select>
                        <span class="error" id="tipoDocumentoError">Debe seleccionar un tipo de documento</span>
                    </div>
                    <div class="form-group">
                        <label for="dni">N° Documento:</label>
                        <input type="text" id="dni" placeholder="Número de Documento" pattern="\d{8}" required>
                        <span class="error" id="dniError">El número de documento es inválido</span>
                    </div>
                    <div class="form-group">
                        <label for="registerPassword">Contraseña:</label>
                        <input type="password" id="registerPassword" placeholder="Contraseña" pattern=".{8,}" required>
                        <span class="error" id="passwordError">La contraseña debe tener al menos 8 caracteres</span>
                    </div>
                    <div class="form-group">
                        <label for="repeatPassword">Repetir Contraseña:</label>
                        <input type="password" id="repeatPassword" placeholder="Repetir Contraseña" required>
                        <span class="error" id="repeatPasswordError">Las contraseñas no coinciden</span>
                    </div>
                    <button type="button" class="btn-next" id="nextToStep2">Siguiente</button>
                    <p class="switch-form">
                        ¿Ya tienes cuenta? <a href="#" id="showLogin">Ingresar</a>
                    </p>
                </div>

                <!-- Paso 2: Datos Personales -->
                <div class="form register-form" id="step2Form" style="display: none;">
                    <img src="../assets/log1.png" alt="Logo" class="logo">
                    <div class="form-group">
                        <label for="firstName">Nombre:</label>
                        <input type="text" id="firstName" placeholder="Nombre" pattern="[A-Za-z]{4,16}" required>
                        <span class="error" id="firstNameError">El nombre debe tener entre 4 y 16 letras</span>
                    </div>
                    <div class="form-group">
                        <label for="lastName">Apellido:</label>
                        <input type="text" id="lastName" placeholder="Apellido" pattern="[A-Za-z]{4,16}" required>
                        <span class="error" id="lastNameError">El apellido debe tener entre 4 y 16 letras</span>
                    </div>
                    <div class="form-group">
                        <label for="dob">Fecha de Nacimiento:</label>
                        <input type="date" id="dob" required>
                        <span class="error" id="dobError">La fecha de nacimiento es obligatoria</span>
                    </div>
                    <div class="form-group">
                        <label for="phone">Teléfono:</label>
                        <input type="text" id="phone" placeholder="Teléfono" pattern="\d{10}" required>
                        <span class="error" id="phoneError">El teléfono debe tener 10 dígitos</span>
                    </div>
                    <!-- Nuevo campo de Dirección -->
                    <div class="form-group">
                        <label for="address">Dirección:</label>
                        <input type="text" id="address" placeholder="Dirección" required>
                        <span class="error" id="addressError">La dirección es obligatoria</span>
                    </div>
                    <!-- Nuevo campo de Email -->
                    <div class="form-group">
                        <label for="email">Email:</label>
                        <input type="email" id="email" placeholder="Email" required>
                        <span class="error" id="emailError">Por favor, introduce un email válido</span>
                    </div>
                    <!-- Nuevo campo de Grupo Sanguíneo -->
                    <div class="form-group">
                        <label for="bloodGroup">Grupo Sanguíneo:</label>
                        <select id="bloodGroup" required>
                            <option value="" disabled selected>Seleccionar grupo sanguíneo</option>
                            <option value="A+">A+</option>
                            <option value="A-">A-</option>
                            <option value="B+">B+</option>
                            <option value="B-">B-</option>
                            <option value="AB+">AB+</option>
                            <option value="AB-">AB-</option>
                            <option value="O+">O+</option>
                            <option value="O-">O-</option>
                        </select>
                        <span class="error" id="bloodGroupError">Debe seleccionar un grupo sanguíneo</span>
                    </div>
                    
                    <div class="buttons-container">
                        <button type="button" class="btn-prev" id="backToStep1">Anterior</button>
                        <button type="button" class="btn-next" id="nextToStep3">Siguiente</button>
                    </div>
                </div>
                    <!-- Paso 3: Datos del Tutor o Representante -->
                    <div class="form register-form" id="step3Form" style="display: none;">
                        <img src="../assets/log1.png" alt="Logo" class="logo">
                        <!-- Nuevo select para Tipo de Documento -->
                    <div class="form-group">
                        <label for="tipoDocumento">Tipo de Documento:</label>
                        <select id="tipoDocumento" required>
                            <option value="" disabled selected>Seleccionar tipo de documento</option>
                            <option value="DNI">DNI</option>
                            <option value="Pasaporte">Pasaporte</option>
                            <option value="CUIL">CUIL</option>
                            <option value="Cedula">Cédula de Identidad</option>
                        </select>
                        <span class="error" id="tipoDocumentoError">Debe seleccionar un tipo de documento</span>
                    </div>
                    <div class="form-group">
                        <label for="tutorDNI">N° Documento:</label>
                        <input type="text" id="tutorDNI" placeholder="Número de Documento" pattern="\d{8}" title="El número de documento es inválido" required>
                        <span class="error" id="tutorDNIError">El número de documento es inválido</span>
                    </div>
                    <div class="form-group">
                        <label for="tutorPhone">Teléfono del Tutor:</label>
                        <input type="text" id="tutorPhone" placeholder="Teléfono del Tutor" pattern="\d{10}" title="El teléfono debe tener 10 dígitos" required>
                        <span class="error" id="tutorPhoneError">El teléfono debe tener 10 dígitos</span>
                    </div>
                    <div class="form-group">
                        <label for="tutorFirstName">Nombre del Tutor:</label>
                        <input type="text" id="tutorFirstName" placeholder="Nombre del Tutor" pattern="[A-Za-z]{4,16}" required>
                        <span class="error" id="tutorFirstNameError">El nombre del tutor debe tener entre 4 y 16 letras</span>
                    </div>
                    <div class="form-group">
                        <label for="tutorLastName">Apellido del Tutor:</label>
                        <input type="text" id="tutorLastName" placeholder="Apellido del Tutor" pattern="[A-Za-z]{4,16}" required>
                        <span class="error" id="tutorLastNameError">El apellido del tutor debe tener entre 4 y 16 letras</span>
                    </div>
                    <div class="form-group">
                        <label for="relationship">Relación:</label>
                        <input type="text" id="relationship" placeholder="Relación" pattern="[A-Za-z\s]{4,16}" required>
                        <span class="error" id="relationshipError">La relación debe tener entre 4 y 16 letras</span>
                    </div>
                    <div class="buttons-container">
                        <button type="button" class="btn-prev" id="backToStep2">Anterior</button>
                        <button type="submit" class="btn-register" id="registerButton">Registrar</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="footer">
            <div class="footer-content">
                <img src="../assets/union-logo.png" alt="Logo Unión Mediterránea de Taekwondo" class="footer-logo">
            
                <div class="footer-icons-container">
                  <div class="icon-arrow">
                    <a href="#"><i class="fa-solid fa-arrow-up"></i></a>
                  </div>
                  <div class="footer-icons">
                    <a target="_blank" href="https://www.facebook.com/p/Union-Mediterranea-de-Taekwondo-100063475813834/"><i class="fa-brands fa-facebook"></i></a>
                    <a target="_blank" href="https://www.instagram.com/union_mediterranea/"><i class="fa-brands fa-instagram"></i></a>
                    <a target="_blank" href="#"><i class="fa-brands fa-youtube"></i></a>
                    <a target="_blank" href="https://wa.me/3517014308"><i class="fa-brands fa-whatsapp"></i></a>
                  </div>
                  <a href="mailto:supportunion@gmail.com" class="footer-email">supportunion@gmail.com</a>
                </div>
            
                <div class="footer-right">
                  <img src="../assets/fetra-logo.png" alt="Logo Federación Taekwondo" class="footer-logo">
                </div>
              </div>
        </div>
        

        <div class="footer-bottom">
          <p>UNION MEDITERRANEA DE TAEKWONDO 2024</p>   
        </div>
    </footer>
    
        <!-- Script para el manejo del formulario por pasos y login -->
        <script src="../controllers/form-registro.js"></script>
        <script src="../controllers/public/menu.js"></script>
  
        <script src="https://cdn.jsdelivr.net/npm/jwt-decode/build/jwt-decode.min.js"></script>
        <script>
            function handleLoginSubmit(event) {
                event.preventDefault();
        
                const dni = document.getElementById('loginUsername').value;
                const password = document.getElementById('loginPassword').value;
        
                fetch('http://localhost:3000/miembros/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        dni: dni,
                        password: password
                    })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.token) {
                        localStorage.setItem('authToken', data.token);
        
                        const decodedToken = jwt_decode(data.token);
                        const userStatus = decodedToken.estado;
        
                        if (userStatus === false) {
                            window.location.href = 'https://www.mercadopago.com.ar/...'; // Redirige a la página de cobros
                        } else if (userStatus === true) {
                            showAlert('success', '¡Inicio de sesión exitoso!'); // Mensaje de éxito
                            window.location.href = 'getway.html'; // Redirige a la página de perfil
                        } else {
                            showAlert('aviso', 'Estado de usuario no reconocido');
                        }
                    } else {
                        showAlert('error', 'Credenciales incorrectas');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    showAlert('error', 'Hubo un problema al iniciar sesión');
                    
                });
            }
        
            // Enlaza la función al evento submit del formulario
            document.addEventListener('DOMContentLoaded', function() {
                document.getElementById('loginForm').addEventListener('submit', handleLoginSubmit);
            });
        </script>
        
    </body>
    </html>
    